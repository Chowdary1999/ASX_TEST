<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ASX Swing Trader — Top 3 (AI + Tracking + Fees)</title><script src="https://cdn.tailwindcss.com"></script><script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script><script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script><style>body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:#0b1020;color:#e2e8f0}.card{background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));border:1px solid rgba(148,163,184,.15);border-radius:1rem}.glass{background:rgba(255,255,255,.06);border:1px solid rgba(148,163,184,.18);border-radius:.75rem}.btn{transition:transform .06s ease}.btn:active{transform:translateY(1px)}.muted{color:#94a3b8}.pill{padding:.15rem .5rem;border-radius:.5rem;font-size:.75rem}.row{border-top:1px dashed rgba(148,163,184,.2);padding-top:.5rem;margin-top:.5rem}input,select,button{outline:none}</style></head><body class=min-h-screen><div id=root></div><script type=text/babel>
const {useState,useEffect}=React;const API='/.netlify/functions/market';function feeFor(c){c=Number(c||0);if(c<=1000)return 5;if(c<=3000)return 10;if(c<=10000)return 19.95;if(c<=25000)return 29.95;return 29.95}function breakdown(capital,entry){const buy=feeFor(capital),sell=feeFor(capital);const qty=Math.max(0,Math.floor(Number(capital)/Number(entry)));const invested=qty*Number(entry)+buy;const total=buy+sell;const be=qty>0?(Number(capital)+total)/qty:null;return{qty,buyFee:buy,sellFee:sell,totalFees:total,invested,breakeven:be}}function expectedPL(entry,exitPrice,qty,buyFee,sellFee){if(qty<=0||!isFinite(entry)||!isFinite(exitPrice))return null;return(Number(exitPrice)-Number(entry))*Number(qty)-(Number(buyFee)+Number(sellFee))}function netTarget(entry,capital,profitPct){const {qty,buyFee,sellFee}=breakdown(capital,entry);if(qty<=0)return null;const requiredNet=Number(capital)*(Number(profitPct)/100);return Number(entry)+(requiredNet+buyFee+sellFee)/qty}function useLocal(k,i){const [v,setV]=useState(()=>{try{const s=localStorage.getItem(k);return s?JSON.parse(s):i}catch{return i}});useEffect(()=>{try{localStorage.setItem(k,JSON.stringify(v))}catch{}},[v]);return [v,setV]}
function Header({capital,setCapital,profitPct,setProfitPct}){return(<header className=p-6><h1 className="text-2xl md:text-3xl font-semibold">ASX Swing Trader <span className=text-violet-400>· top 3 picks</span></h1><div className="text-slate-300 text-sm mt-2 flex flex-wrap gap-4 items-center"><div className="flex items-center gap-2"><span className=muted>Default capital (AUD):</span><input type=number min=50 step=1 className="glass px-3 py-2 rounded-md w-40 text-slate-100" value={capital} onChange={e=>setCapital(Math.max(0,Number(e.target.value||0)))} /></div><div className="flex items-center gap-2"><span className=muted>Profit % (net):</span><input type=number min=1 step=0.1 className="glass px-3 py-2 rounded-md w-28 text-slate-100" value={profitPct} onChange={e=>setProfitPct(Math.max(0,Number(e.target.value||0)))} /></div><span className="muted text-xs">CommSec fees auto-applied · buy + sell</span></div></header>)}
function ErrorLine({msg}){return msg?<p className="text-sm text-rose-400">⚠️ {msg}</p>:null}
function Top3({capital,profitPct}){const [picks,setPicks]=useState([]);const [asOf,setAsOf]=useState(null);const [err,setErr]=useState(null);const [loading,setLoading]=useState(false);const [refreshMins,setRefreshMins]=useLocal('refreshMins',5);const [mode,setMode]=useLocal('pickMode','fast');async function refresh(){setErr(null);setLoading(true);try{const res=await fetch(`${API}?fn=pick3&mode=${mode}&t=${Date.now()}`);const data=await res.json();if(data.error)throw new Error(data.error);setPicks(data.picks||[]);setAsOf(data.asOf||null);}catch(e){setErr(e.message);setPicks([])}finally{setLoading(false)}}useEffect(()=>{refresh()},[mode]);useEffect(()=>{let id=null;const m=Number(refreshMins||0);if(m>0){id=setInterval(()=>refresh(),m*60*1000)}return()=>id&&clearInterval(id)},[refreshMins,mode]);return(<div className="card p-5 md:p-6 space-y-3"><div className="flex items-center justify-between"><div><h2 className="text-lg font-semibold">Top 3 Daily Picks</h2><div className="text-xs text-slate-400">{asOf?`as of ${new Date(asOf).toLocaleString()}`:''}</div></div><div className="flex gap-2 items-center"><span className="muted text-xs">Picker:</span><select className="glass px-2 py-1 rounded" value={mode} onChange={e=>setMode(e.target.value)}><option value=fast>Fast</option><option value=full>Full</option></select><span className="muted text-xs">Auto-refresh:</span><select className="glass px-2 py-1 rounded" value={refreshMins} onChange={e=>setRefreshMins(Number(e.target.value))}><option value=1>1 min</option><option value=5>5 min</option><option value=15>15 min</option><option value=0>Off</option></select><button className="btn px-3 py-1.5 rounded-lg bg-slate-700 hover:bg-slate-600" onClick={refresh} disabled={loading}>{loading?'Loading…':'Refresh'}</button></div></div><ErrorLine msg={err}/>{picks.length===0&&!err&&<p className=muted>Finding candidates…</p>}<div className=space-y-2>{picks.map((p,i)=>{const bd=breakdown(capital,p.entry);const tgt=netTarget(p.entry,capital,profitPct);const stop=p.entry*0.95;const tPL=expectedPL(p.entry,tgt,bd.qty,bd.buyFee,bd.sellFee);const sPL=expectedPL(p.entry,stop,bd.qty,bd.buyFee,bd.sellFee);return(<div key={p.symbol} className="glass p-3 rounded-lg space-y-1"><div className="flex justify-between items-center"><div><span className=font-semibold>#{p.rank||i+1} {p.symbol}</span> <span className="text-xs text-slate-400">{p.name||''}</span></div><span className="pill bg-white/10">Score {p.score!=null?p.score.toFixed(2):'—'}</span></div><div className=text-sm>Entry {p.entry?.toFixed?.(4)} · Target (net +{profitPct}%){tgt?`: $${tgt.toFixed(4)}`:''} · Stop {stop.toFixed(4)} · Qty @ A$ {capital}: {bd.qty}</div><div className="text-xs text-slate-300">Capital A$ {capital} · Buy Fee A$ {bd.buyFee.toFixed(2)} · Sell Fee A$ {bd.sellFee.toFixed(2)} · Total Fees A$ {bd.totalFees.toFixed(2)} · Break-even {bd.breakeven?bd.breakeven.toFixed(4):'—'}</div><div className=text-xs>Expected P/L at Target: <span className={(tPL||0)>=0?'text-emerald-400':'text-rose-400'}>{tPL!=null?`A$${tPL.toFixed(2)}`:'—'}</span> · at Stop: <span className={(sPL||0)>=0?'text-emerald-400':'text-rose-400'}>{sPL!=null?`A$${sPL.toFixed(2)}`:'—'}</span></div></div>)})}</div></div>)}
function App(){const [capital,setCapital]=useLocal('capital',1000);const [profitPct,setProfitPct]=useLocal('profitPct',7.5);return(<div className="max-w-6xl mx-auto p-4 md:p-8 space-y-6"><Header capital={capital} setCapital={setCapital} profitPct={profitPct} setProfitPct={setProfitPct}/><Top3 capital={capital} profitPct={profitPct}/></div>)}const root=ReactDOM.createRoot(document.getElementById('root'));root.render(<App/>);</script></body></html>